---
title: "端口监控"
linkTitle: "端口监控"
date: 2021-05-27
description: >
  端口监控是一种典型的黑盒监控的手段，如果端口都没在监听显然这个进程是出问题了，夜莺内置了端口监控的能力，我们建议所有的物理机、虚拟机上面部署的关键进程，都要配上端口监控
---


端口分两类，一个是TCP一个是UDP，TCP的端口如何探测是否在监听？只需要由agentd发起连接尝试即可，如果连接失败了，就认为没在监听；对于UDP的端口，没法像TCP那样探测，agentd会去尝试listen一个相同的端口，如果listen失败，就认为这个端口已经在监听了，否则就认为这个端口没在监听。

配置端口采集时，需要填写多个字段的内容，各个字段的含义简要介绍如下：

- **采集名称**：给这条采集策略取个名字，可以是中文，比如“n9e-mysql端口监控”
- **端口协议**：根据你的端口监听的协议自行选择即可，大部分都是TCP的
- **端口号**：要监控的端口号，比如3306
- **连接超时**：TCP类型的端口agentd会去尝试连接，如果连接失败就认为端口没有在监听，既然是连接就要设置超时时间
- **采集周期**：端口监控的探测周期
- **附加标签**：这个字段非常重要，通常用于附加一些维度信息。比如n9e服务用的mysql端口是3306，如果告警的时候只是报出3306端口挂了，我们很难知道是哪个数据库，这种情况我们就可以附加一些标签，用于做维度标识，比如附上：`service=mysql,business=n9e`就一下子清楚的知道这是给n9e这个业务用的mysql服务啦

